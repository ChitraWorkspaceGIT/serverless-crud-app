import json
import boto3

dynamodb = boto3.resource('dynamodb')
table = dynamodb.Table('ItemsTable')

def lambda_handler(event, context):
    method = event['requestContext']['http']['method']

    if method == "GET":
        # Return all items
        items = table.scan()
        return {"statusCode": 200, "body": json.dumps(items['Items'])}

    elif method == "POST":
        # Add new item
        body = json.loads(event['body'])
        table.put_item(Item=body)
        return {"statusCode": 200, "body": "Item added"}

    elif method == "DELETE":
        # Delete item by ID
        item_id = event['pathParameters']['id']
        table.delete_item(Key={'id': item_id})
        return {"statusCode": 200, "body": "Item deleted"}

    return {"statusCode": 400, "body": "Unsupported method"}
